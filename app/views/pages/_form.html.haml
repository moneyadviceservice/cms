- content_for :nav_secondary do
  %li.nav-secondary__item.nav-secondary__item--right
    = render 'comfy/admin/cms/sites/mirrors', object: @page

- content_for :right_column do
  = render 'form_save'
  = render 'comfy/admin/cms/files/index'

%div{data:{dough_component: 'StickyElements'}}
  = form_for @page, as: :page,
                    url: form_url,
                    class: 'form',
                    html: { multipart: true, autocomplete: 'off'},
                    data: { dough_component: 'MASEditor UnsavedChangesPrompt', dough_scheduler_form: true } do |form|

    = render 'comfy/admin/cms/partials/page_form_before', object: form
    .l-panel-content.l-panel-content--form
      .l-constrained{ data: page_form_component(@page.new_record?, default: ['URLFormatter'], optional: ['MirrorInputValue']), 'data-dough-urlformatter-base-url' => '{pageType}/{slug}'}

        = render 'form_title', form: form

        - if @site.layouts.any?
          = render 'form_layout', form: form

        = form.hidden_field :scheduled_on, data: {'dough-scheduler-on' => ''}

        = render 'form_slug', form: form
        = render 'comfy/admin/cms/partials/page_form_inner', form: form
        = render 'comfy/admin/cms/categories/form',          form: form
        = render 'tags/shared/form',                         form: form
        = render 'form_meta_description',                    form: form
        = render 'form_meta_title',                          form: form
        = render 'form_additional_options',                  form: form

    - @page.site.layouts.pluck(:identifier).reject { |identifier| identifier == 'home_page' }.each do |identifier|
      - if lookup_context.exists? "#{identifier}", ['pages/form_blocks'], true
        = render partial: "pages/form_blocks/#{identifier}", locals: { identifier: identifier }

    = render partial: 'form_blocks', locals: { identifier: :main }

    = render 'scheduler', object: form
    = render 'footer_bar', object: form
    = render 'comfy/admin/cms/partials/page_form_after', object: form

= render 'activity_log_box'
= render 'insert_link_dialog'
= render 'insert_image_dialog'
